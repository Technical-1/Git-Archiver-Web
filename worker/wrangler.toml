# Cloudflare Worker Configuration
# See https://developers.cloudflare.com/workers/wrangler/configuration/

name = "git-archiver"
main = "src/index.js"
compatibility_date = "2024-01-01"

# KV Namespace for rate limiting
# ⚠️  DEPLOYMENT REQUIRED: You MUST replace the ID below before deploying!
# To set up:
# 1. Run: wrangler kv:namespace create "RATE_LIMIT"
# 2. Copy the ID from the output and replace "REPLACE_WITH_YOUR_KV_NAMESPACE_ID" below
# 3. The worker will fail-closed (reject all requests) if KV is unavailable
[[kv_namespaces]]
binding = "RATE_LIMIT"
id = "2c10cf8e59ca4d4bbe141128201f1a5c"

# Environment variables (set via wrangler secret)
# Run: wrangler secret put GITHUB_TOKEN
# Run: wrangler secret put GITHUB_OWNER
# Run: wrangler secret put GITHUB_REPO

[vars]
# Public variables (non-secret)
#
# CORS Configuration:
# ALLOWED_ORIGIN = "*" is intentionally set to allow cross-origin requests from any domain.
# This is a PUBLIC API designed to be embedded and used by:
# - The official frontend hosted on GitHub Pages
# - Third-party tools and integrations
# - Browser extensions and scripts
#
# Security considerations:
# - The API is read-heavy (index, readme, status) with aggressive caching
# - Write operations (submit, bulk-submit) are protected by rate limiting per IP
# - No authentication or session cookies are used (stateless)
# - All sensitive operations validate input server-side
#
# If you fork this project for private use, consider restricting to your domain:
# ALLOWED_ORIGIN = "https://yourdomain.com"
ALLOWED_ORIGIN = "*"
